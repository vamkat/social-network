# 1. Namespaces
kubectl apply -R -f k8s --selector stage=namespace

# 2. Helm nginx
helm upgrade --install nginx-ingress ingress-nginx/ingress-nginx \
    -n ingress-nginx --create-namespace

# 3. PVCs
kubectl apply -R -f k8s --selector stage=pvc

# 4. DB
kubectl apply -R -f k8s --selector stage=db

# 5. DB migration Jobs
kubectl apply -R -f k8s --selector stage=migration

# 6. Configs / Secrets
kubectl apply -R -f k8s --selector stage=config

# 7. App Deployments + Services
kubectl apply -R -f k8s --selector stage=app

# 8. Ingress
kubectl apply -R -f k8s --selector stage=ingress
