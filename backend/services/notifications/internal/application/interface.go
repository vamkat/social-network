package application

import (
	"context"

	"social-network/services/notifications/internal/db/sqlc"
)

// DBInterface represents the interface for database operations
// This matches the methods generated by sqlc in the Queries struct
type DBInterface interface {
	CreateNotification(ctx context.Context, arg sqlc.CreateNotificationParams) (sqlc.Notification, error)
	GetNotificationByID(ctx context.Context, id int64) (sqlc.Notification, error)
	GetUserNotifications(ctx context.Context, arg sqlc.GetUserNotificationsParams) ([]sqlc.Notification, error)
	GetUserNotificationsCount(ctx context.Context, userID int64) (int64, error)
	GetUserUnreadNotificationsCount(ctx context.Context, userID int64) (int64, error)
	MarkNotificationAsRead(ctx context.Context, arg sqlc.MarkNotificationAsReadParams) error
	MarkAllAsRead(ctx context.Context, userID int64) error
	DeleteNotification(ctx context.Context, arg sqlc.DeleteNotificationParams) error
	CreateNotificationType(ctx context.Context, arg sqlc.CreateNotificationTypeParams) error
	GetNotificationType(ctx context.Context, notifType string) (sqlc.NotificationType, error)
}

// Update the Application struct to use the interface
type Application struct {
	DB DBInterface
}

// NewApplication creates a new notification application service
func NewApplication(db DBInterface) *Application {
	return &Application{
		DB: db,
	}
}